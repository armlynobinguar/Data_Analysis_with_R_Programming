library(readr)
# Heads up that the following instruction can generate a column specification warnings, you can ignore that.
# These warnings are related to that `readr` has misguidedly guessed the type of values in the column `Pool QC`. 
# To avoid this warning we can manually specify the type of this column the `col_types` parameter.
houses  <-  read_tsv('AmesHousing_1.txt', col_types = cols(`Pool QC` = col_character())) 

library(dplyr)
houses_per_year  <-  houses %>%
    mutate(Year = `Yr Sold`) %>%
    group_by(Year) %>%
    summarize(MeanPrice = mean(SalePrice), 
              HousesSold = n() ) %>%
    arrange(HousesSold)
mean_new  <-  mean(houses_per_year$MeanPrice)
mean_original  <-  mean(houses$SalePrice)
difference  <-  mean_original - mean_new

houses_per_year  <- houses_per_year %>%
    mutate(sum_per_year = MeanPrice * HousesSold)

all_sums_together  <-  sum(houses_per_year$sum_per_year)
total_n_houses  <-  sum(houses_per_year$HousesSold)
weighted_mean  <-  all_sums_together / total_n_houses

mean_original  <-  mean(houses$SalePrice)

difference  <-  round(mean_original, digits = 10) - round(weighted_mean, digits = 10)
